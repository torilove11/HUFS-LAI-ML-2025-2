# 프로젝트 요약 및 결과

### 1. 주제
- 네이버 식당 리뷰 긍정/부정 분류기 (Sentiment Analysis)
- 한국어 리뷰 텍스트를 분석하여 긍정(1) 또는 부정(0)을 예측하는 모델 구축
- 단순히 리뷰 단위의 분석이 아닌, 문장 단위의 세분화된 감성 파악을 목표로 함
--------------------------------------------------
### 2. 데이터셋
#### 2.1. 데이터셋 구성
- Public Dataset : kr3(korean restaurant review with ratings) 공개 데이터셋 (약 64만 개)
- My Dataset : 공개 데이터셋의 일부 리뷰를 샘플링하여 문장으로 쪼갠 뒤 직접 라벨링한 데이터셋 (약 1,000개)
#### 2.2. 전처리 및 분할
- Stratified Group Split(Data Leakage 방지)
    - 하나의 리뷰에서 나온 여러 문장들이 같은 영역(train/val/test)에 속하도록 분할
- 분할 비율
  - Public Data: Train(80%) / Validation(10%) / Test(10%)
  - Custom Data: Train(60%) / Validation(20%) / Test(20%)
- 클래스 불균형 해결
  - 식당 리뷰 데이터 특성상 긍정 리뷰가 부정 리뷰보다 많음 (약 5.7배)
  - 이를 보정하기 위해 Loss Function에 Class Weight[5.7, 1.0]를 적용
--------------------------------------------------
### 3. Model architecture
- Base Model : beomi/kcbert-base (KcBERT: Korean comments BERT, Hugging Face Transformers)
- 한국어 구어체의 댓글 데이터에 특화된 pre-trained 모델을 불러와 fine-tuning 진행
--------------------------------------------------
### 4. 학습 설정
- Epochs : 2 (데이터의 양이 많아 작게 잡음, 2 epochs만으로 충분히 유의미한 성능이 나옴)
- Batch size : 32
- Learning Rate : 2e-5 (Linear Schedule with Warmup)
- Optimizer : AdamW
- Loss function : Weighted CrossEntropyLoss (소수 클래스인 부정 리뷰 맞추는 데에 집중)
- Environment : Google Colab (GPU: Tesla T4)
--------------------------------------------------
### 5. 평가 지표 및 성능 결과
#### 5.1. 핵심 지표
- Macro F1-Score (데이터의 불균형이 존재)
- Negative-Recall (부정 리뷰의 감지를 중요하게 생각)

#### 5.2. 최종 테스트 결과 (Test Dataset)

![Confusion Matrix](https://drive.google.com/uc?id=1KH-piP2j6groLrBCdUIbwtiHMfHgYS-v)

| Metric | Score |
|-----------|------|
| Total Accuracy | 0.9650 | 
| Macro F1-Score | 0.9344 |
| **Negative-recall** | **0.9018** | 
| Negative-precision | 0.8775 | 
--------------------------------------------------
### 5.3. 오류 분석

모델이 잘못 예측한 리뷰 30개를 무작위로 샘플링하여 3가지 항목으로 나누어 오류의 원인을 분석

**1.  모델이 실제로 잘못 예측 (7/30)**
<details>
<summary>클릭하여 예시를 확인</summary>

- 예시 [1] 문장 : 간단하게 맥주 한 잔 먹고 나와야지.. 이랬다가 사케 들이붓고 젖었네요..
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [4] 문장 : 2015.7.23 현재 돌 냄비는 메뉴에 없더라 겨울에 하나??그냥 메밀이랑 비빔 냄비 3개 먹어봤다.  냄비는 국물이 그렇게 많이 짜지 않고 면의 굵기나 삶아진 정도도 적당해서 맛있게 먹었다. 그냥 판밀 같은 경유 쯔위가 좀 달았다. 먹으면서 압구정 하루랑 코엑스 현백에 송이 생각났음. 비빔국수도 조금 달았음 단맛을 줄이고 새콤한 맛이 좀 더 있었으면 좋겠다....
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [7] 문장 : 돈 벌고 싶어지는 맛!
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [10] 문장 : 난 아직 평양냉면이 어렵다
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [12] 문장 : 이천 왔으니 밥 먹음. 사람 많은 맛 집이라 퀄리티 유지가 힘든 듯.
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [15] 문장 : 계산하는 분이 손님이고 제가 직원인 줄 알았네요. 맛은 나쁘지 않습니다.
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [17] 문장 : 은평구 토박이라면 한 번쯤은 가봤을만한 오래된 집입니다. 15년 전부터 먹어왔는데 이미 그때부터 늘 가게 밖에 대기 줄어 있었던 곳이죠. 좌석이 좁고 시끄럽고 불편해도 미나리 향익 은은한 실한 오징어볶음 맛에 종종 갔었는데 백종원의 삼대 천왕? 방송 이후로 줄이 너무 길어져 잘 못 갔습니다. 방송 빨 빠지고 다시 예전만큼의 웨이팅이길래 갔는데 미나리가 부추로 바뀌었더군요. 그래도 오징어는 여전히 실하니까... 하며 먹었어요. 3년 전인가 마지막 갔을 때 몇 안 되는 반찬인 생당근 스틱은 물기 하나 없이 말라있고 미역냉국 미역은 덜 불려 후들거리고 여전히 미나리 대신 부추를 쓰더군요. 계산하며 냉국 미역이 덜 불었다고 조용히 말씀드렸는데 아예 하고 건성으로 대답하길래 그 뒤로는 가지 않습니다. 종종 생각나는 맛이었는데... 아쉽네요....
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive)
</details>

**2. 정보성/애매한 리뷰 (9/30)**
<details>
<summary>클릭하여 예시를 확인</summary>

- 예시 [2] 문장 : crowded but comfy
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [3] 문장 : 오징어볶음 맛나고 순댓국은 좀 짜요
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [5] 문장 : 아주아주 맛있지는 않고 그럭저럭 먹을만
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [6] 문장 : 와이프랑 둘이서 17만 원...
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [8] 문장 : 맛있고 무지 비쌈
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [13] 문장 : 맛었서요
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [14] 문장 : 제피가루에 맛이 파. 괴. 될 수 있으니 아예 넣지 말든지 조금만 넣어드세요!
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [20] 문장 : 5시 반까지 브레이크 타임
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [25] 문장 : 술은 안 먹고 파전만 먹고 나오는 집 파전 성애자?
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))
</details>

**3. 명확하게 잘못 라벨링된 데이터 (14/30)**
<details>
<summary>클릭하여 예시를 확인</summary>

- 예시 [9] 문장 : 전화 왜 안 바다요 ....
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [11] 문장 : 가격이 저렴한 게 아닌데 밥이 제공_않고 따로 공깃밥을 시켜야 되는 게 아쉽네요.
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [16] 문장 : 58도씨가 결국 바뀌고 말았다  이제 펄예궈 추가는 500원 내야 되고 얼음 조절도 안된다  예전에는 얼음 없이 먹으면 양이 그만큼 많아졌었는데...... 58도씨도 변해가는 경제상황에 굴복................. 오늘은 코코넛을 먹어보았는데 그냥 편의점 코코넛 우유랑 맛 비슷해서 굳이 사 마실 필요는 없는 듯!
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [18] 문장 : 오징어 음식이 왜 이렇게 양이 코딱지야
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [19] 문장 : 좀만 저렴하면 좋을 텐데..
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [21] 문장 : 건강해지는 맛이로군요. 고기 없으니 두부 같은 건 있을 거라 생각했는데
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [22] 문장 : 너무 기대하면서 갔는지 그렇게 맛있는지 모르겠어요. 웨이팅은 엄청 해야 해요
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [23] 문장 : 여름인지라 사람이 굉장히 많습니다. 화장실 한번 가려면 줄 서야 할 판이에요  맛은 그냥 무난한 설빙의 맛. 아르바이트생들 힘들겠다 싶을 정도로 바쁜 집입니다... 시끌벅적해요.
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [24] 문장 : 과천 외곽의 카페에요 저는 기대보단 그저 그랬습니다 카페라기보다는 꽃집입니다
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [26] 문장 : 세상에 머리 나쁜 사람들 참 많다.
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [27] 문장 : 가격 대비 별로이었네요 ... 생각보다 시끄럽기도 하고... 재방문은 안 할듯합니다
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [28] 문장 : 발레도 굉장히 불편하며, 그냥저냥 재료 사서 올려먹을 수 있는 정도의 음식 수준이다
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))

- 예시 [29] 문장 : 런치에 먹을 수 있는 볼트 버거는 늘 정말 최고인 것 같아요! 여기만 한 육즙과 퀄리티의 패티를 아직은 못 봤어요 날 좋으니 곧 테라스에서 또 즐길 수 있겠네요 디너에 스테이크도 맛있고, 분위기도 조용하고 좋아요. 꼭 추가해서 즐기는 베이컨도 짱 맛있어요 
  - 실제 라벨 : 0 (부정 (Negative))
  - 예측 라벨 : 1 (긍정 (Positive))

- 예시 [30] 문장 : 솔직히 서래 마을....에서 인기를 끌만한 수준의 맛은 아니라고 생각된다. 파스타면 도 마음에 안 들고. 취향 문제인가 싶기도 하다, 좋아하는 사람도 많으니.
  - 실제 라벨 : 1 (긍정 (Positive))
  - 예측 라벨 : 0 (부정 (Negative))
</details>

무작위로 샘플링된 30개의 오답 데이터는 전체 오류 케이스의 약 1.8%로 전체를 대표한다고 보기는 어렵지만, 약 50%가 데이터셋 자체의 라벨링 오류로 밝혀졌다. 이는 모델이 잘못 예측한 것이 아닌 데이터셋의 문제로 모델의 성능이 실제보다 수치적으로 낮게 측정된 것으로 보인다. 또한 오류 케이스의 30%가 정보성/애매한 리뷰인데, 이런 리뷰는 원본 공개 데이터셋 내에서 긍정(1), 부정(0)이 아닌 2로 따로 라벨링되어 있었어야 한다. 데이터셋의 품질 문제가 있었고, 평가에서 실제 성능보다 낮게 측정된 것을 감안하면 그럼에도 불구하고 결과적으로는 꽤 좋은 성능이 나온 것 같다. 데이터셋의 품질을 높이면 성능이 더 오를 것으로 보인다.

--------------------------------------------------
### 5.4. 예시 추론

- **Case 1: 명확한 긍정**
  - 입력: "와 여기 진짜 인생 맛집입니다. 케이크가 촉촉하고 과일도 잔뜩 들었어요. 주문할 때 이것저것 여쭤봤는데 사장님도 정말 친절해요! 집에서 좀 먼데도 자주 올 것 같아요."
  - 결과: 긍정 (Positive) (확률: 99.93%)
    
- **Case 2: 전반적으로는 긍정이나 살짝 불만이 섞인 리뷰**
  - 입력: "맛은 있네요. 고기가 질이 좋고 직원분이 고기도 다 구워주세요. 반찬도 다양하고 좋음. 그런데 가격이 비싸고 웨이팅도 길어서 특별한 날 말고는 안 올듯 싶네요."
  - 결과: 긍정 (Positive) (확률: 96.03%)
    
- **Case 3: 전반적으로는 부정이나 살짝 칭찬이 섞인 리뷰**
  - 입력: "인테리어 깔끔하고 자리가 넓어서 분위기는 예쁨. 그런데 메인이 생각보다 별로고 가격 대비 만족도가 떨어져서 굳이 재방문은 안 할듯. 근처에 비슷한 가격대에 더 맛있는 집 많음."
  - 결과: 부정 (Negative) (확률: 95.98%)
    
- **Case 4: 명확한 부정**
  - 입력: "멀리서 일부러 찾아올 정도는 아닌 것 같네요. 리뷰 괜찮아서 온 건데 다른 데 갈 걸 후회됩니다. 시간도 돈도 아까워요."
  - 결과: 부정 (Negative) (확률: 99.81%)
    
- **Case 5: 신조어 (긍정)**
  - 입력: "가성비 오지네요. JMT!"
  - 결과: 긍정 (Positive) (확률: 99.75%)
    
- **Case 6: 영어 리뷰 (부정)**
  - 입력: "The restaurant looked cozy and the staff were friendly. They greeted us with a smile. But the food itself was really disappointing. The main dish was a bit cold, and the side dishes tasted like they had been sitting out for a while."
  - 결과: 긍정 (Positive) (확률: 93.19%)

전반적으로는 같은 긍정/부정 리뷰라고 해도 그 안에 반대 클래스의 문장이 섞여있는 경우를 유의미하게 구별해내는 것으로 보인다. (확률 99.93% -> 96.03%, 99.81% -> 95.98%) 한국어 텍스트 기반 BERT 모델을 fine-tuning한 탓에 영어 리뷰는 잘 분류하지 못 하는 것 같다. 관광객/외국인의 관점이 나와는 차이가 있을 것으로 생각돼 영어 리뷰의 중요도가 높진 않지만, 다국어 모델(mBERT 등)을 사용하면 성능이 올라갈 것으로 보인다.

### 6. 파일 저장 위치
- 최종 모델 : https://drive.google.com/drive/folders/1XDptDMgve0UTtlVLLhMsRcOt3-G97EnL?usp=sharing
- 최종 모델(zip) : https://drive.google.com/file/d/1iwRFkAnueiGc9SPCzylBbPavJZ163fSz/view?usp=sharing
- 원본 데이터셋
  - https://drive.google.com/file/d/1GS-dPWviShlEqv4B3IJc9_3j9nOqfJGy/view?usp=drive_link
  - https://drive.google.com/file/d/1hEqeVe_7eOytxLVUw1O2Rb-M0G0j_zSo/view?usp=sharing
- 분할된 데이터셋 : https://drive.google.com/drive/folders/11blsa1Wab4IFmaLdwEF_WLxP2eTYC5u9?usp=sharing
